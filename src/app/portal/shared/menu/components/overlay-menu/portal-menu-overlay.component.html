<button mat-button
  *ngIf="root; else child"
  [matMenuTriggerFor]="menu">
    {{ parent | translatable: 'name' | async }}
</button>

<ng-template #child>
  <button mat-menu-item
    *ngIf="!root"
    [matMenuTriggerFor]="menu"
    (menuOpened)="retrieveSubmenu()">
      {{ parent | translatable: 'name' | async }}
</button>
</ng-template>

<mat-menu #menu="matMenu">
  <ng-container *ngFor="let subItem of subMenuItems | async">
    
    <app-portal-menu-overlay
      *ngIf="(subItem?.subMenuItems?.length || 0) > 0; else entries"
      [parent]="subItem">
    </app-portal-menu-overlay>
    
    <ng-template #entries>
      <button class="subItem"
        mat-menu-item
        (click)="route(subItem)">
        <fa-icon class="menu-icon" [icon]="['fas', icon(subItem?.icon)]"></fa-icon>
        <section>{{ subItem | translatable: 'name' | async }}
          <small>{{ subItem | translatable: 'shortDescription' | async }}</small>
        </section>
        <fa-icon class="arrow-right" [icon]="['fas', 'arrow-right']"></fa-icon>
      </button>
    </ng-template>

  </ng-container>
</mat-menu>