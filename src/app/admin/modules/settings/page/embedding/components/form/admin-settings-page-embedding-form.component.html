<form [formGroup]="form">
  <app-row columns="2" formGroupName="base">
    <mat-form-field appearance="outline" [appAssignColumns]="1">
      <mat-label appLabel="label"></mat-label>
      <input matInput formControlName="label">
    </mat-form-field>
  </app-row>

  <mat-divider></mat-divider>

  @if (hasControl(form.controls.plugin, 'plugin')) {
    <app-row
      columns="2"
      [formGroup]="form.controls.plugin">
      <mat-form-field appearance="outline">
        <mat-label appLabel="plugin"></mat-label>
        <mat-select [formControl]="getControl(form.controls.plugin, 'plugin')">
          @for (plugin of plugins | async; track plugin) {
            <mat-option
              [value]="plugin.id">
              <span>{{ plugin | translatable: "name" | async }}</span>
            </mat-option>
          }
        </mat-select>
      </mat-form-field>
    </app-row>
  }

  @if (hasControl(form.controls.title, 'title')) {
  <app-row
    columns="2"
    [formGroup]="form.controls.title">
    <mat-form-field
        appearance="outline">
        <mat-label appLabel="title"></mat-label>
        <input matInput [formControl]="getControl(form.controls.title, 'title')">
      </mat-form-field>
  </app-row>
}

  @if (hasControl(form.controls.buttonUrl, 'button')
    || hasControl(form.controls.buttonUrl, 'url')) {
    <app-row
      columns="2"
      [formGroup]="form.controls.buttonUrl">
      @if (hasControl(form.controls.buttonUrl, 'button')) {
        <mat-form-field
          appearance="outline">
          <mat-label appLabel="buttonText"></mat-label>
          <input matInput [formControl]="getControl(form.controls.buttonUrl, 'button')">
        </mat-form-field>
      }

      @if (hasControl(form.controls.buttonUrl, 'url')) {
        <mat-form-field
          appearance="outline">
          <mat-label appLabel="buttonUrl"></mat-label>
          <input matInput [formControl]="getControl(form.controls.buttonUrl, 'url')">
        </mat-form-field>
      }
    </app-row>
  }
  @if (hasControl(form.controls.textMedium, 'text')
    || hasControl(form.controls.textMedium, 'media')) {
    <app-row
      columns="2" [formGroup]="form.controls.textMedium">
      @if (hasControl(form.controls.textMedium, 'text')) {
        <app-ck-editor-form
          [formControl]="getControl(form.controls.textMedium, 'text')">
        </app-ck-editor-form>
      }
      @if (hasControl(form.controls.textMedium, 'media')) {
        <app-media-form
          class="text-media"
          [formControl]="getControl(form.controls.textMedium, 'media')"
          [maxFiles]="1">
        </app-media-form>
      }
    </app-row>
  }
  @if (hasControl(form.controls.media, 'multimedia')) {
    <div
      [formGroup]="form.controls.media">
      <app-media-form [formControl]="getControl(form.controls.media, 'multimedia')">
      </app-media-form>
    </div>
  }
  <button mat-stroked-button
    appLabel="save"
    [disabled]="form.invalid"
    (click)="update()">
  </button>
</form>